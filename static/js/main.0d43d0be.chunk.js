(this["webpackJsonpreact-blog"]=this["webpackJsonpreact-blog"]||[]).push([[0],{21:function(n,e,t){},25:function(n,e,t){"use strict";t.r(e);var c,a,o,i,r,s=t(0),j=t.n(s),b=t(13),d=t.n(b),l=(t(21),t(5)),x=t(3),u=t(4),p=t(7),O=t(2),h="token",f=function(n){localStorage.setItem(h,n)},g=function(){return localStorage.getItem(h)},m="https://student-json-api.lidemy.me",v=function(){var n=g();return fetch("".concat(m,"/me"),{headers:{authorization:"Bearer ".concat(n)}}).then((function(n){return n.json()}))},w=t(1),y=u.a.div(c||(c=Object(x.a)(["\n  border-bottom: 1px rgba(0, 0, 0, 0.9) solid;\n  padding: 20px 24px;\n  cursor: pointer;\n  &:hover {\n    background: rgba(0, 0, 0, 0.3)\n  }\n"]))),S=u.a.div(a||(a=Object(x.a)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center\n"]))),k=Object(u.a)(p.b)(o||(o=Object(x.a)(["\n  font-weight: bold;\n  font-size: 32px;\n  text-decoration: none;\n  color: black\n"]))),z=u.a.div(i||(i=Object(x.a)(["\n  font-size: 24px;\n  color: rgba(0, 0, 0, 0.3)\n"])));function C(n){var e=n.post;return Object(w.jsx)(y,{children:Object(w.jsxs)(S,{children:[Object(w.jsx)(k,{to:"/posts/".concat(e.id),children:e.title}),Object(w.jsx)(z,{children:new Date(e.createdAt).toLocaleString()})]})})}var F=u.a.div(r||(r=Object(x.a)(["\n"])));function B(){var n=Object(s.useState)([]),e=Object(l.a)(n,2),t=e[0],c=e[1];return Object(s.useEffect)((function(){fetch("".concat(m,"/posts?_sort=createdAt&_order=desc")).then((function(n){return n.json()})).then((function(n){return c(n)}))}),[]),Object(w.jsx)(F,{children:t.map((function(n){return Object(w.jsx)(C,{post:n},n.id)}))})}var L,N,P,D,I,E,J,T,U,$,A=Object(s.createContext)(null),_=u.a.form(L||(L=Object(x.a)(["\n  display: flex;\n  border: 1px black solid;\n  flex-direction: column;\n  align-items: center;\n  border: 1px #000000solid solid;\n  height: 60vh;\n  width: 50%;\n  margin: 200px auto;\n  padding: 40px;\n  box-sizing: border-box;\n  label {\n    margin-top: 20px\n  }\n"]))),M=u.a.div(N||(N=Object(x.a)(["\n  font-size: 48px\n"]))),q=u.a.input(P||(P=Object(x.a)(["\n  width: 100%;\n  margin-top: 16px;\n  height: 40px;\n"]))),G=u.a.button(D||(D=Object(x.a)(["\n  height: 56px;\n  width: 100px;\n  margin-top: 73px;\n"]))),H=u.a.div(I||(I=Object(x.a)(["\n  color: red;\n  font-size: 24px\n"])));function K(){var n=Object(s.useContext)(A).setUser,e=Object(s.useState)(""),t=Object(l.a)(e,2),c=t[0],a=t[1],o=Object(s.useState)(""),i=Object(l.a)(o,2),r=i[0],j=i[1],b=Object(s.useState)(""),d=Object(l.a)(b,2),x=d[0],u=d[1],p=Object(O.f)(),h=function(n){var e=n.target.value;return n.target.classList.contains("username")?a(e):j(e)},g=function(n){u("")};return Object(w.jsxs)(_,{onSubmit:function(e){e.preventDefault(),u(""),function(n,e){return fetch("".concat(m,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:n,password:e})}).then((function(n){return n.json()}))}(c,r).then((function(e){0===e.ok&&u(e.message),f(e.token),v().then((function(e){if(1!==e.ok)return f(null),u("\u67e5\u7121\u4f7f\u7528\u8005");n(e.data),p("/")}))}))},children:[Object(w.jsx)(M,{children:"Login"}),x&&Object(w.jsx)(H,{children:x}),Object(w.jsx)("label",{for:"username",children:"Username"}),Object(w.jsx)(q,{className:"username",id:"username",onChange:h,onFocus:g,value:c}),Object(w.jsx)("label",{for:"password",children:"Password"}),Object(w.jsx)(q,{className:"password",id:"password",type:"password",onChange:h,onFocus:g,value:r}),Object(w.jsx)(G,{children:"\u767b\u5165"})]})}function Q(){return Object(w.jsx)(K,{})}var R,V,W,X,Y,Z,nn,en=u.a.div(E||(E=Object(x.a)(["\n  text-align: center;\n  margin: 0 auto;\n  margin-top: 100px;\n  box-sizing: border-box;\n  padding: 20px;\n  width: 900px;\n  border: solid #9a9a9a 1px;\n  div + div {\n    margin-top: 20px;\n  }\n  @media (max-width: 768px) {\n    max-width: 600px;\n  }\n"]))),tn=u.a.div(J||(J=Object(x.a)(["\n  font-size: 36px;\n  font-weight: bold;\n"]))),cn=u.a.div(T||(T=Object(x.a)(["\n  font-size: 24px;\n  background: #eee; \n"]))),an=u.a.div(U||(U=Object(x.a)(["\n  padding: 15px;\n  text-align: left;\n  font-size: 24px;\n"]))),on=Object(u.a)(p.b)($||($=Object(x.a)(["\n  padding: 3px 12px;\n  border: solid 1px #a8a8a8;\n  color: #a8a8a8;\n  text-decoration: none;\n  font-size: 14px;\n  border-radius: 5px;\n  cursor: pointer\n"])));function rn(n){var e=n.article;return console.log("render:",e),Object(w.jsxs)(en,{children:[Object(w.jsx)(tn,{children:e.title}),Object(w.jsx)(cn,{children:new Date(e.createdAt).toLocaleString()}),Object(w.jsx)(an,{children:e.body}),Object(w.jsx)("div",{children:Object(w.jsx)(on,{to:"/",children:"\u8fd4\u56de\u9996\u9801"})})]})}function sn(){var n=Object(s.useState)([]),e=Object(l.a)(n,2),t=e[0],c=e[1],a=Object(O.g)().id;return Object(s.useEffect)((function(){(function(n){return fetch("".concat(m,"/posts?id=").concat(n)).then((function(n){return n.json()}))})(a).then((function(n){return c(n[0])}))}),[a]),Object(w.jsx)(rn,{article:t})}var jn,bn,dn,ln,xn,un=u.a.form(R||(R=Object(x.a)(["\n  padding: 12px 20px;\n  text-align: center;\n  display: flex;\n  flex-direction: column;\n  border: 1px black solid;\n  width: 900px;\n  margin: 0 auto;\n  margin-top: 100px;\n  @screen and (max-width: 768px) {\n    max-width: 600px\n  }\n"]))),pn=u.a.input(V||(V=Object(x.a)(["\n  margin-top: 32px;\n  height: 40px\n"]))),On=u.a.textarea(W||(W=Object(x.a)(["\n  margin-top: 32px;\n"]))),hn=u.a.div(X||(X=Object(x.a)(["\n  margin-top: 20px;\n"]))),fn=u.a.input(Y||(Y=Object(x.a)(["\n  float: left\n"]))),gn=Object(u.a)(p.b)(Z||(Z=Object(x.a)(["\n  float: right;\n  text-decoration: none\n"]))),mn=u.a.div(nn||(nn=Object(x.a)(["\n  color: red;\n  font-size: 24px\n"])));function vn(){var n=Object(O.f)(),e=Object(s.useState)(""),t=Object(l.a)(e,2),c=t[0],a=t[1],o=Object(s.useState)(""),i=Object(l.a)(o,2),r=i[0],j=i[1],b=Object(s.useState)(""),d=Object(l.a)(b,2),x=d[0],u=d[1],p=function(n){var e=n.target;return e.classList.contains("title")?a(e.value):j(e.value)},h=function(){u("")};return Object(w.jsxs)(un,{onSubmit:function(e){e.preventDefault(),function(n,e){var t=g();return fetch("".concat(m,"/posts"),{method:"POST",headers:{authorization:"Bearer ".concat(t),"content-type":"application/json"},body:JSON.stringify({title:n,body:e})}).then((function(n){return n.json()}))}(c,r).then((function(e){if(0===e.ok)return u(e.message);n("/")}))},children:[Object(w.jsx)("h1",{children:"\u767c\u5e03\u6587\u7ae0"}),x&&Object(w.jsx)(mn,{children:x}),Object(w.jsx)(pn,{className:"title",value:c,onChange:p,onFocus:h}),Object(w.jsx)(On,{className:"content",rows:10,value:r,onChange:p,onFocus:h}),Object(w.jsxs)(hn,{children:[Object(w.jsx)(fn,{type:"submit",value:"\u9001\u51fa"}),Object(w.jsx)(gn,{to:"/",children:"\u8fd4\u56de\u9996\u9801"})]})]})}function wn(){return Object(w.jsx)(vn,{})}var yn,Sn=u.a.div(jn||(jn=Object(x.a)(["\n  background: #333333;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  border-bottom: 1px rgba(0, 0, 0, 0.2) solid;\n  color: #2828FF;\n  padding: 0px 32px;\n  box-shadow: 0px 5px 2px 1px rgba(0, 0, 0, 0.2);\n"]))),kn=u.a.div(bn||(bn=Object(x.a)(["\n  display: flex;\n  align-items: center;\n"]))),zn=u.a.div(dn||(dn=Object(x.a)(["\n  display: inline-block;\n  font-size: 48px;\n  font-weight: bold;\n  margin-right: 32px\n"]))),Cn=u.a.ul(ln||(ln=Object(x.a)(["\n  list-style-type: none;\n  margin: auto 0;\n  padding: 0;\n  overflow: hidden;\n  background-color: #333333;\n  display: inline-block;\n"]))),Fn=Object(u.a)(p.b)(xn||(xn=Object(x.a)(["\n  cursor: pointer;\n  font-size: 36px;\n  display: inline-block;\n  color: white;\n  text-align: center;\n  padding: 16px 32px;\n  text-decoration: none;\n\n  ","\n"])),(function(n){return n.$active&&"background: #7B7B7B"}));function Bn(){var n=Object(s.useContext)(A),e=n.user,t=n.setUser,c=Object(O.f)(),a=Object(O.e)();return Object(w.jsxs)(Sn,{children:[Object(w.jsxs)(kn,{children:[Object(w.jsx)(zn,{children:"Blog"}),Object(w.jsxs)(Cn,{children:[Object(w.jsx)(Fn,{to:"/",$active:"/"===a.pathname,children:"\u9996\u9801"}),e&&Object(w.jsx)(Fn,{to:"/newpost",$active:"/newpost"===a.pathname,children:"\u767c\u5e03\u6587\u7ae0"})]})]}),Object(w.jsx)(kn,{children:Object(w.jsx)(Cn,{children:e?Object(w.jsx)(Fn,{to:"",onClick:function(){f(null),t(""),c("/")},children:"\u767b\u51fa"}):Object(w.jsx)(Fn,{to:"/login",$active:"/login"===a.pathname,children:"\u767b\u5165"})})})]})}var Ln=u.a.div(yn||(yn=Object(x.a)([""])));var Nn=function(){var n=Object(s.useState)(null),e=Object(l.a)(n,2),t=e[0],c=e[1];return Object(s.useEffect)((function(){localStorage.getItem("token")&&v().then((function(n){n.ok&&c(n.data)}))}),[]),Object(w.jsx)(A.Provider,{value:{user:t,setUser:c},children:Object(w.jsx)(Ln,{children:Object(w.jsxs)(p.a,{children:[Object(w.jsx)(Bn,{}),Object(w.jsxs)(O.c,{children:[Object(w.jsx)(O.a,{exact:!0,path:"/",element:Object(w.jsx)(B,{})}),Object(w.jsx)(O.a,{exact:!0,path:"/login",element:Object(w.jsx)(Q,{})}),Object(w.jsx)(O.a,{exact:!0,path:"/newpost",element:Object(w.jsx)(wn,{})}),Object(w.jsx)(O.a,{exact:!0,path:"/posts/:id",element:Object(w.jsx)(sn,{})})]})]})})})},Pn=function(n){n&&n instanceof Function&&t.e(3).then(t.bind(null,26)).then((function(e){var t=e.getCLS,c=e.getFID,a=e.getFCP,o=e.getLCP,i=e.getTTFB;t(n),c(n),a(n),o(n),i(n)}))};d.a.render(Object(w.jsx)(j.a.StrictMode,{children:Object(w.jsx)(Nn,{})}),document.getElementById("root")),Pn()}},[[25,1,2]]]);
//# sourceMappingURL=main.0d43d0be.chunk.js.map